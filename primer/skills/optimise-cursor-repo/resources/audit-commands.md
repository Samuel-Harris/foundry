# Audit Commands Reference

Bash commands for each audit area. Run these to gather information about the repository's Cursor configuration.

## 1. Indexing Exclusions

```bash
# Read existing ignore files
cat .cursorignore 2>/dev/null
cat .cursorindexingignore 2>/dev/null

# Check .gitattributes for LFS-tracked paths (these are often binary)
grep "filter=lfs" .gitattributes 2>/dev/null

# Find large non-code directories that might pollute the index
du -sh */ --max-depth=2 2>/dev/null | sort -rh | head -20

# Count files in suspect directories
find <directory> -type f | wc -l

# Check for generated code directories
find . -name "gen" -o -name "generated" -o -name "__generated__" | head -20
```

## 2. Rules Configuration

```bash
# List existing rules
ls -la .cursor/rules/ 2>/dev/null

# Check for legacy .cursorrules
ls -la .cursorrules 2>/dev/null

# Read each rule file to assess scope and size
wc -l .cursor/rules/* 2>/dev/null

# Find all always-apply rules
grep -l "alwaysApply: true" .cursor/rules/* 2>/dev/null

# Find apply-intelligently rules (consider migrating to skills if procedural)
# These have description but no globs and no alwaysApply: true
for f in .cursor/rules/*.mdc; do
  if grep -q "^description:" "$f" && ! grep -q "^globs:" "$f" && ! grep -q "alwaysApply: true" "$f"; then
    echo "Apply-intelligently rule: $f"
  fi
done 2>/dev/null
```

## 3. AGENTS.md Documentation

```bash
# Find all AGENTS.md files
find . -name "AGENTS.md" -type f | sort

# Check root AGENTS.md size (large = candidate for trimming)
wc -l AGENTS.md 2>/dev/null

# Check timestamps
grep "Updated:" */AGENTS.md 2>/dev/null
```

## 4. Context Weight

```bash
# Measure root AGENTS.md
wc -l AGENTS.md 2>/dev/null

# Find all always-apply rules
grep -l "alwaysApply: true" .cursor/rules/* 2>/dev/null

# Total context weight
wc -l AGENTS.md .cursor/rules/* 2>/dev/null
```

## 5. Hooks

```bash
# Read existing hooks
cat .cursor/hooks.json 2>/dev/null

# List hook scripts
ls .cursor/hooks/ 2>/dev/null

# Check for virtual environment indicators
ls .conda/ .venv/ venv/ .python-version .nvmrc .node-version 2>/dev/null
```

## 6. Generated and Binary Files

```bash
# Check for LFS paths
grep "filter=lfs" .gitattributes 2>/dev/null

# Look for generated code markers
grep -r "auto-generated\|DO NOT EDIT\|generated by" --include="*.ts" --include="*.py" -l . 2>/dev/null | head -20

# Find large non-code files
find . -type f \( -name "*.sql" -o -name "*.pkl" -o -name "*.dat" -o -name "*.bin" -o -name "*.pdf" -o -name "*.png" -o -name "*.jpg" -o -name "*.webm" -o -name "*.zip" -o -name "*.tar.gz" \) -not -path "*/node_modules/*" -not -path "*/.git/*" 2>/dev/null | head -30
```

## 8. Skills

```bash
# List existing skills
ls -R .cursor/skills/ 2>/dev/null

# Check skill descriptions and sizes
for skill in .cursor/skills/*/SKILL.md; do
  echo "=== $skill ==="
  head -5 "$skill"
  wc -l "$skill"
done 2>/dev/null
```

## 9. Artefact Validation

**IMPORTANT:** Don't just check existence — read each file to verify correct frontmatter structure.

Use the validation script for automated checking:

```bash
# Run from project root
.cursor/skills/optimise-cursor-repo/scripts/validate-artefacts.sh
```

The script validates:

- **Skills** — Must have `name` and `description` in frontmatter
- **Rules** — Checks for empty globs, redundant alwaysApply+globs, identifies Apply Intelligently rules
- **Subagents** — Warns on missing `description` (needed for auto-delegation), validates model values

## 10. Commands (Legacy)

```bash
# List existing commands (can be migrated to skills via /migrate-to-skills)
ls .cursor/commands/ 2>/dev/null
```

## 11. Subagents

```bash
# List existing subagents
ls .cursor/agents/ 2>/dev/null

# Check subagent frontmatter and descriptions
for agent in .cursor/agents/*.md; do
  echo "=== $agent ==="
  head -10 "$agent"
done 2>/dev/null
```

## 12. MCP Server Configuration

```bash
# Read existing MCP config
cat .cursor/mcp.json 2>/dev/null
cat mcp.json 2>/dev/null

# Identify project services from docker-compose, requirements, etc.
grep -l "postgres\|redis\|mysql\|mongo" docker-compose*.yml 2>/dev/null
cat requirements.txt 2>/dev/null | grep -i "linear\|jira\|github\|stripe"
```

## 13. Plugins

```bash
# Check for installed plugins
ls .cursor/plugins/ 2>/dev/null
```

## 14. Sandbox

```bash
cat sandbox.json 2>/dev/null
```
